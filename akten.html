
<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <title>Aktenverwaltung</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <nav class="sidebar">
    <h2>CopNet</h2>
    <a href="dashboard.html">Dashboard</a>
    <a href="akten.html" class="active">Akten</a>
    <a href="fahndungen.html">Fahndungen</a>
    <a href="personalakten.html">Personalakten</a>
    <a href="status.html">Status</a>
    <button id="logout-btn">Logout</button>
  </nav>

  <main class="content">
    <header>
      <h1>Aktenverwaltung</h1>
      <button id="add-akten-btn">Neue Akte erstellen</button>
    </header>
    <section id="akten-list"></section>
  </main>

  <script type="module">
    import { auth, db } from "./firebase.js";
    import { onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-auth.js";
    import { collection, getDocs, addDoc, deleteDoc, doc } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore.js";

    const logoutBtn = document.getElementById("logout-btn");
    const aktenListEl = document.getElementById("akten-list");
    const addAktenBtn = document.getElementById("add-akten-btn");

    onAuthStateChanged(auth, user => {
      if (!user) window.location.href = "login.html";
    });

    logoutBtn.addEventListener("click", async () => {
      await signOut(auth);
      window.location.href = "login.html";
    });

    async function loadAkten() {
      aktenListEl.innerHTML = "";
      const querySnapshot = await getDocs(collection(db, "akten"));
      querySnapshot.forEach((docSnap) => {
        const akte = docSnap.data();
        const div = document.createElement("div");
        div.textContent = `${akte.name} - ${akte.beschreibung}`;
        aktenListEl.appendChild(div);
      });
    }

    addAktenBtn.addEventListener("click", async () => {
      const name = prompt("Name der Person:");
      if (!name) return;
      const beschreibung = prompt("Beschreibung:");
      if (!beschreibung) return;
      await addDoc(collection(db, "akten"), { name, beschreibung });
      loadAkten();
    });

    loadAkten();
  </script>
</body>
</html>
